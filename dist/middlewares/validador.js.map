{"version":3,"file":"validador.js","names":["jwt","require","config","secret","process","env","SECRET","validateToken","req","res","next","accessToken","query","authorization","status","send","verify","err","user","name"],"sources":["../../src/middlewares/validador.js"],"sourcesContent":["const jwt = require('jsonwebtoken')\r\nrequire('dotenv').config('../../.env');\r\nconst secret = process.env.SECRET;\r\n\r\nexport const validateToken = (req, res, next) => {\r\n  const accessToken = req.query.authorization;\r\n\r\n  if (!accessToken) {\r\n    return res.status(401).send('Acceso denegado: Falta token de autorización');\r\n  }\r\n\r\n  jwt.verify(accessToken, secret, (err, user) => {\r\n    if (err) {\r\n      if (err.name === 'TokenExpiredError') {\r\n        return res.status(401).send('Acceso denegado: Token expirado');\r\n      }\r\n      return res.status(401).send('Acceso denegado: Token no válido');\r\n    }\r\n    req.user = user;\r\n    next();\r\n  });\r\n};"],"mappings":";;;;;;;AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACAA,OAAO,CAAC,QAAD,CAAP,CAAkBC,MAAlB,CAAyB,YAAzB;;AACA,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAR,CAAYC,MAA3B;;AAEO,MAAMC,aAAa,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;EAC/C,MAAMC,WAAW,GAAGH,GAAG,CAACI,KAAJ,CAAUC,aAA9B;;EAEA,IAAI,CAACF,WAAL,EAAkB;IAChB,OAAOF,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,8CAArB,CAAP;EACD;;EAEDf,GAAG,CAACgB,MAAJ,CAAWL,WAAX,EAAwBR,MAAxB,EAAgC,CAACc,GAAD,EAAMC,IAAN,KAAe;IAC7C,IAAID,GAAJ,EAAS;MACP,IAAIA,GAAG,CAACE,IAAJ,KAAa,mBAAjB,EAAsC;QACpC,OAAOV,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,iCAArB,CAAP;MACD;;MACD,OAAON,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kCAArB,CAAP;IACD;;IACDP,GAAG,CAACU,IAAJ,GAAWA,IAAX;IACAR,IAAI;EACL,CATD;AAUD,CAjBM"}