{"version":3,"file":"validador.js","names":["jwt","require","config","secret","process","env","SECRET","validateToken","req","res","next","accessToken","body","authorization","send","verify","err","user"],"sources":["../../src/middlewares/validador.js"],"sourcesContent":["const jwt = require('jsonwebtoken')\nrequire('dotenv').config('../../.env');\nconst secret = process.env.SECRET;\n\n\nexport const validateToken = async (req, res, next) => {\n    const accessToken = req.body.authorization;\n    if(!accessToken) res.send('acceso denegado');\n  \n    jwt.verify(accessToken, secret, (err, user) =>{\n      if(err){\n        res.send('acceso denegado, token expirado');\n      }else {\n        next();\n      }\n    } )\n  }\n"],"mappings":";;;;;;;AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACAA,OAAO,CAAC,QAAD,CAAP,CAAkBC,MAAlB,CAAyB,YAAzB;;AACA,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAR,CAAYC,MAA3B;;AAGO,MAAMC,aAAa,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;EACnD,MAAMC,WAAW,GAAGH,GAAG,CAACI,IAAJ,CAASC,aAA7B;EACA,IAAG,CAACF,WAAJ,EAAiBF,GAAG,CAACK,IAAJ,CAAS,iBAAT;EAEjBd,GAAG,CAACe,MAAJ,CAAWJ,WAAX,EAAwBR,MAAxB,EAAgC,CAACa,GAAD,EAAMC,IAAN,KAAc;IAC5C,IAAGD,GAAH,EAAO;MACLP,GAAG,CAACK,IAAJ,CAAS,iCAAT;IACD,CAFD,MAEM;MACJJ,IAAI;IACL;EACF,CAND;AAOD,CAXI"}