{"version":3,"file":"idiomasOfertas.js","names":["models","require","getAll","req","res","idiomas_ofertas","findAll","attributes","then","send","catch","sendStatus","postIdiomasOfertas","create","fk_id_idioma","body","idIdioma","fk_id_oferta","idOferta","fk_id_nivel","idNivel","status","id","error","console","log","findPorId","onSuccess","onNotFound","onError","findOne","include","as","model","idiomas","ofertas","niveles_idiomas","where","getPorId","params"],"sources":["../../src/controllers/idiomasOfertas.js"],"sourcesContent":["const models = require(\"../../database/models\");\r\n\r\nexport const getAll = async (req, res) => {\r\n\r\n  models.idiomas_ofertas\r\n    .findAll({\r\n      attributes: [\"id\",\"fk_id_idioma\",\"fk_id_oferta\",\"fk_id_nivel\"]\r\n    }).then(idiomas_ofertas => res.send({\r\n      idiomas_ofertas\r\n      \r\n    })).catch(() => res.sendStatus(500));\r\n};\r\n\r\nexport const postIdiomasOfertas = async (req, res) => {\r\n  models.idiomas_ofertas\r\n    .create({\r\n      fk_id_idioma: req.body.idIdioma,     \r\n      fk_id_oferta: req.body.idOferta,          \r\n      fk_id_nivel: req.body.idNivel,         \r\n    })\r\n    .then(\r\n      (idiomas_ofertas) => res.status(201).send({ id: idiomas_ofertas.id }))\r\n\r\n    .catch((error) => {\r\n      if (error == \"SequelizeUniqueConstraintError: Validation error\") {\r\n        res.status(401).send(\"Bad request: Algun tipo de error de validacion de campos\");\r\n      } else {\r\n        console.log(`Error al intentar insertar en la base de datos: ${error}`);\r\n        res.sendStatus(500);\r\n      }\r\n    });\r\n};\r\n\r\nconst findPorId = (\r\n  fk_id_oferta,\r\n  { onSuccess, onNotFound, onError }\r\n) => {\r\n  models.idiomas_ofertas\r\n    .findOne({\r\n      include: [\r\n        {\r\n          as: \"Idioma\",\r\n          model: models.idiomas,\r\n          attributes: [\"id\", \"nombre_idioma\"],\r\n        },\r\n        {\r\n          as: \"Oferta\",\r\n          model: models.ofertas,\r\n          attributes: [\"id\", \"titulo_oferta\"],\r\n        },\r\n        {\r\n          as: \"Nivel\",\r\n          model: models.niveles_idiomas,\r\n          attributes: [\"id\", \"nivel\"],\r\n        },\r\n      ],\r\n\r\n      where: { fk_id_oferta },\r\n    })\r\n    .then((idiomas_ofertas) =>\r\n      idiomas_ofertas ? onSuccess(idiomas_ofertas) : onNotFound()\r\n    )\r\n    .catch(() => onError());\r\n};\r\n\r\nexport const getPorId = async (req, res) => {\r\n  findPorId(req.params.id, {\r\n    onSuccess: (idiomas_ofertas) => res.send(idiomas_ofertas),\r\n    onNotFound: () => res.sendStatus(401),\r\n    onError: () => res.sendStatus(400),\r\n  });\r\n};\r\n"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,uBAAD,CAAtB;;AAEO,MAAMC,MAAM,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;EAExCJ,MAAM,CAACK,eAAP,CACGC,OADH,CACW;IACPC,UAAU,EAAE,CAAC,IAAD,EAAM,cAAN,EAAqB,cAArB,EAAoC,aAApC;EADL,CADX,EAGKC,IAHL,CAGUH,eAAe,IAAID,GAAG,CAACK,IAAJ,CAAS;IAClCJ;EADkC,CAAT,CAH7B,EAMMK,KANN,CAMY,MAAMN,GAAG,CAACO,UAAJ,CAAe,GAAf,CANlB;AAOD,CATM;;;;AAWA,MAAMC,kBAAkB,GAAG,OAAOT,GAAP,EAAYC,GAAZ,KAAoB;EACpDJ,MAAM,CAACK,eAAP,CACGQ,MADH,CACU;IACNC,YAAY,EAAEX,GAAG,CAACY,IAAJ,CAASC,QADjB;IAENC,YAAY,EAAEd,GAAG,CAACY,IAAJ,CAASG,QAFjB;IAGNC,WAAW,EAAEhB,GAAG,CAACY,IAAJ,CAASK;EAHhB,CADV,EAMGZ,IANH,CAOKH,eAAD,IAAqBD,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB;IAAEa,EAAE,EAAEjB,eAAe,CAACiB;EAAtB,CAArB,CAPzB,EASGZ,KATH,CASUa,KAAD,IAAW;IAChB,IAAIA,KAAK,IAAI,kDAAb,EAAiE;MAC/DnB,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB,0DAArB;IACD,CAFD,MAEO;MACLe,OAAO,CAACC,GAAR,CAAa,mDAAkDF,KAAM,EAArE;MACAnB,GAAG,CAACO,UAAJ,CAAe,GAAf;IACD;EACF,CAhBH;AAiBD,CAlBM;;;;AAoBP,MAAMe,SAAS,GAAG,CAChBT,YADgB,EAEhB;EAAEU,SAAF;EAAaC,UAAb;EAAyBC;AAAzB,CAFgB,KAGb;EACH7B,MAAM,CAACK,eAAP,CACGyB,OADH,CACW;IACPC,OAAO,EAAE,CACP;MACEC,EAAE,EAAE,QADN;MAEEC,KAAK,EAAEjC,MAAM,CAACkC,OAFhB;MAGE3B,UAAU,EAAE,CAAC,IAAD,EAAO,eAAP;IAHd,CADO,EAMP;MACEyB,EAAE,EAAE,QADN;MAEEC,KAAK,EAAEjC,MAAM,CAACmC,OAFhB;MAGE5B,UAAU,EAAE,CAAC,IAAD,EAAO,eAAP;IAHd,CANO,EAWP;MACEyB,EAAE,EAAE,OADN;MAEEC,KAAK,EAAEjC,MAAM,CAACoC,eAFhB;MAGE7B,UAAU,EAAE,CAAC,IAAD,EAAO,OAAP;IAHd,CAXO,CADF;IAmBP8B,KAAK,EAAE;MAAEpB;IAAF;EAnBA,CADX,EAsBGT,IAtBH,CAsBSH,eAAD,IACJA,eAAe,GAAGsB,SAAS,CAACtB,eAAD,CAAZ,GAAgCuB,UAAU,EAvB7D,EAyBGlB,KAzBH,CAyBS,MAAMmB,OAAO,EAzBtB;AA0BD,CA9BD;;AAgCO,MAAMS,QAAQ,GAAG,OAAOnC,GAAP,EAAYC,GAAZ,KAAoB;EAC1CsB,SAAS,CAACvB,GAAG,CAACoC,MAAJ,CAAWjB,EAAZ,EAAgB;IACvBK,SAAS,EAAGtB,eAAD,IAAqBD,GAAG,CAACK,IAAJ,CAASJ,eAAT,CADT;IAEvBuB,UAAU,EAAE,MAAMxB,GAAG,CAACO,UAAJ,CAAe,GAAf,CAFK;IAGvBkB,OAAO,EAAE,MAAMzB,GAAG,CAACO,UAAJ,CAAe,GAAf;EAHQ,CAAhB,CAAT;AAKD,CANM"}