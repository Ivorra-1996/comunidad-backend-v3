{"version":3,"file":"idiomasOfertas.js","names":["models","require","getAll","req","res","idiomas_ofertas","findAll","attributes","then","send","catch","sendStatus","postIdiomasOfertas","create","fk_id_idioma","body","idIdioma","fk_id_oferta","idOferta","fk_id_nivel","idNivel","status","id","error","console","log","findPorId","onSuccess","onNotFound","onError","findOne","include","as","model","idiomas","ofertas","niveles_idiomas","where","getPorId","params"],"sources":["../../src/controllers/idiomasOfertas.js"],"sourcesContent":["const models = require(\"../../database/models\");\n\nexport const getAll = async (req, res) => {\n\n  models.idiomas_ofertas\n    .findAll({\n      attributes: [\"id\",\"fk_id_idioma\",\"fk_id_oferta\",\"fk_id_nivel\"]\n    }).then(idiomas_ofertas => res.send({\n      idiomas_ofertas\n      \n    })).catch(() => res.sendStatus(500));\n};\n\nexport const postIdiomasOfertas = async (req, res) => {\n  models.idiomas_ofertas\n    .create({\n      fk_id_idioma: req.body.idIdioma,     \n      fk_id_oferta: req.body.idOferta,          \n      fk_id_nivel: req.body.idNivel,         \n    })\n    .then(\n      (idiomas_ofertas) => res.status(201).send({ id: idiomas_ofertas.id }))\n\n    .catch((error) => {\n      if (error == \"SequelizeUniqueConstraintError: Validation error\") {\n        res.status(401).send(\"Bad request: Algun tipo de error de validacion de campos\");\n      } else {\n        console.log(`Error al intentar insertar en la base de datos: ${error}`);\n        res.sendStatus(500);\n      }\n    });\n};\n\nconst findPorId = (\n  fk_id_oferta,\n  { onSuccess, onNotFound, onError }\n) => {\n  models.idiomas_ofertas\n    .findOne({\n      include: [\n        {\n          as: \"Idioma\",\n          model: models.idiomas,\n          attributes: [\"id\", \"nombre_idioma\"],\n        },\n        {\n          as: \"Oferta\",\n          model: models.ofertas,\n          attributes: [\"id\", \"titulo_oferta\"],\n        },\n        {\n          as: \"Nivel\",\n          model: models.niveles_idiomas,\n          attributes: [\"id\", \"nivel\"],\n        },\n      ],\n\n      where: { fk_id_oferta },\n    })\n    .then((idiomas_ofertas) =>\n      idiomas_ofertas ? onSuccess(idiomas_ofertas) : onNotFound()\n    )\n    .catch(() => onError());\n};\n\nexport const getPorId = async (req, res) => {\n  findPorId(req.params.id, {\n    onSuccess: (idiomas_ofertas) => res.send(idiomas_ofertas),\n    onNotFound: () => res.sendStatus(401),\n    onError: () => res.sendStatus(400),\n  });\n};\n"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,uBAAD,CAAtB;;AAEO,MAAMC,MAAM,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;EAExCJ,MAAM,CAACK,eAAP,CACGC,OADH,CACW;IACPC,UAAU,EAAE,CAAC,IAAD,EAAM,cAAN,EAAqB,cAArB,EAAoC,aAApC;EADL,CADX,EAGKC,IAHL,CAGUH,eAAe,IAAID,GAAG,CAACK,IAAJ,CAAS;IAClCJ;EADkC,CAAT,CAH7B,EAMMK,KANN,CAMY,MAAMN,GAAG,CAACO,UAAJ,CAAe,GAAf,CANlB;AAOD,CATM;;;;AAWA,MAAMC,kBAAkB,GAAG,OAAOT,GAAP,EAAYC,GAAZ,KAAoB;EACpDJ,MAAM,CAACK,eAAP,CACGQ,MADH,CACU;IACNC,YAAY,EAAEX,GAAG,CAACY,IAAJ,CAASC,QADjB;IAENC,YAAY,EAAEd,GAAG,CAACY,IAAJ,CAASG,QAFjB;IAGNC,WAAW,EAAEhB,GAAG,CAACY,IAAJ,CAASK;EAHhB,CADV,EAMGZ,IANH,CAOKH,eAAD,IAAqBD,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB;IAAEa,EAAE,EAAEjB,eAAe,CAACiB;EAAtB,CAArB,CAPzB,EASGZ,KATH,CASUa,KAAD,IAAW;IAChB,IAAIA,KAAK,IAAI,kDAAb,EAAiE;MAC/DnB,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB,0DAArB;IACD,CAFD,MAEO;MACLe,OAAO,CAACC,GAAR,CAAa,mDAAkDF,KAAM,EAArE;MACAnB,GAAG,CAACO,UAAJ,CAAe,GAAf;IACD;EACF,CAhBH;AAiBD,CAlBM;;;;AAoBP,MAAMe,SAAS,GAAG,CAChBT,YADgB,EAEhB;EAAEU,SAAF;EAAaC,UAAb;EAAyBC;AAAzB,CAFgB,KAGb;EACH7B,MAAM,CAACK,eAAP,CACGyB,OADH,CACW;IACPC,OAAO,EAAE,CACP;MACEC,EAAE,EAAE,QADN;MAEEC,KAAK,EAAEjC,MAAM,CAACkC,OAFhB;MAGE3B,UAAU,EAAE,CAAC,IAAD,EAAO,eAAP;IAHd,CADO,EAMP;MACEyB,EAAE,EAAE,QADN;MAEEC,KAAK,EAAEjC,MAAM,CAACmC,OAFhB;MAGE5B,UAAU,EAAE,CAAC,IAAD,EAAO,eAAP;IAHd,CANO,EAWP;MACEyB,EAAE,EAAE,OADN;MAEEC,KAAK,EAAEjC,MAAM,CAACoC,eAFhB;MAGE7B,UAAU,EAAE,CAAC,IAAD,EAAO,OAAP;IAHd,CAXO,CADF;IAmBP8B,KAAK,EAAE;MAAEpB;IAAF;EAnBA,CADX,EAsBGT,IAtBH,CAsBSH,eAAD,IACJA,eAAe,GAAGsB,SAAS,CAACtB,eAAD,CAAZ,GAAgCuB,UAAU,EAvB7D,EAyBGlB,KAzBH,CAyBS,MAAMmB,OAAO,EAzBtB;AA0BD,CA9BD;;AAgCO,MAAMS,QAAQ,GAAG,OAAOnC,GAAP,EAAYC,GAAZ,KAAoB;EAC1CsB,SAAS,CAACvB,GAAG,CAACoC,MAAJ,CAAWjB,EAAZ,EAAgB;IACvBK,SAAS,EAAGtB,eAAD,IAAqBD,GAAG,CAACK,IAAJ,CAASJ,eAAT,CADT;IAEvBuB,UAAU,EAAE,MAAMxB,GAAG,CAACO,UAAJ,CAAe,GAAf,CAFK;IAGvBkB,OAAO,EAAE,MAAMzB,GAAG,CAACO,UAAJ,CAAe,GAAf;EAHQ,CAAhB,CAAT;AAKD,CANM"}