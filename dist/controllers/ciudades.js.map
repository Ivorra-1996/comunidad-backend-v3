{"version":3,"file":"ciudades.js","names":["models","require","Op","getConFiltros","req","res","nombreCiudad","query","idProvincia","replace","ciudades","findAll","attributes","where","and","nombre","iLike","fk_id_provincia","eq","order","then","send","catch","sendStatus"],"sources":["../../src/controllers/ciudades.js"],"sourcesContent":["const models = require(\"../../database/models\");\nconst { Op } = require(\"sequelize\");\n\n  //get de ciudades\nexport const getConFiltros = async (req, res) => {\n  let nombreCiudad = req.query.nombreCiudad;\n  let idProvincia = req.query.idProvincia;\n\n  if (typeof nombreCiudad === \"undefined\") {\n    nombreCiudad = \"_\";\n  } else {\n    nombreCiudad = req.query.nombreCiudad.replace(/\\s/g, \"%\");\n  }\n\n  models.ciudades\n    .findAll({\n      attributes: [\"id\",\"nombre\"],\n      where: {\n        [Op.and]: [\n          {\n            nombre: {\n              [Op.iLike]: `%${nombreCiudad}%`,\n            },\n            fk_id_provincia: {\n              [Op.eq]: [idProvincia]\n            },\n          },\n        ],\n      },\n      order: [\"nombre\"],\n    })\n    .then((ciudades) =>\n      res.send({\n        ciudades\n      })\n    )\n    .catch(() => res.sendStatus(500));\n};\n"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,uBAAD,CAAtB;;AACA,MAAM;EAAEC;AAAF,IAASD,OAAO,CAAC,WAAD,CAAtB,C,CAEE;;;AACK,MAAME,aAAa,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;EAC/C,IAAIC,YAAY,GAAGF,GAAG,CAACG,KAAJ,CAAUD,YAA7B;EACA,IAAIE,WAAW,GAAGJ,GAAG,CAACG,KAAJ,CAAUC,WAA5B;;EAEA,IAAI,OAAOF,YAAP,KAAwB,WAA5B,EAAyC;IACvCA,YAAY,GAAG,GAAf;EACD,CAFD,MAEO;IACLA,YAAY,GAAGF,GAAG,CAACG,KAAJ,CAAUD,YAAV,CAAuBG,OAAvB,CAA+B,KAA/B,EAAsC,GAAtC,CAAf;EACD;;EAEDT,MAAM,CAACU,QAAP,CACGC,OADH,CACW;IACPC,UAAU,EAAE,CAAC,IAAD,EAAM,QAAN,CADL;IAEPC,KAAK,EAAE;MACL,CAACX,EAAE,CAACY,GAAJ,GAAU,CACR;QACEC,MAAM,EAAE;UACN,CAACb,EAAE,CAACc,KAAJ,GAAa,IAAGV,YAAa;QADvB,CADV;QAIEW,eAAe,EAAE;UACf,CAACf,EAAE,CAACgB,EAAJ,GAAS,CAACV,WAAD;QADM;MAJnB,CADQ;IADL,CAFA;IAcPW,KAAK,EAAE,CAAC,QAAD;EAdA,CADX,EAiBGC,IAjBH,CAiBSV,QAAD,IACJL,GAAG,CAACgB,IAAJ,CAAS;IACPX;EADO,CAAT,CAlBJ,EAsBGY,KAtBH,CAsBS,MAAMjB,GAAG,CAACkB,UAAJ,CAAe,GAAf,CAtBf;AAuBD,CAjCM"}